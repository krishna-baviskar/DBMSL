Use Java and MongoDB connectivity and Write a MapReduce program for
categorising books as ‚ÄúBig book‚Äù and ‚ÄúSmall book‚Äù based on number of pages.
Books {
Name:‚ÄùUnderstanding mongoDB‚Äù,
Pages: 200}

import com.mongodb.client.*;
import org.bson.Document;
import java.util.Arrays;

public class BookMapReduce {
    public static void main(String[] args) {
        // 1Ô∏è‚É£ Connect to MongoDB
        MongoClient mongoClient = MongoClients.create("mongodb://localhost:27017");
        MongoDatabase db = mongoClient.getDatabase("libraryDB");
        MongoCollection<Document> books = db.getCollection("books");

        // 2Ô∏è‚É£ Insert Sample Documents
        books.drop(); // clear collection first
        books.insertMany(Arrays.asList(
                new Document("Name", "Understanding MongoDB").append("Pages", 200),
                new Document("Name", "Mastering Java").append("Pages", 450),
                new Document("Name", "Python Basics").append("Pages", 180),
                new Document("Name", "Data Structures in Depth").append("Pages", 520)
        ));
        System.out.println("‚úÖ Sample books inserted.");

        // 3Ô∏è‚É£ Map Function
        // Categorize each book as Big or Small
        String mapFunction = "function() { " +
                "if (this.Pages > 300) " +
                "   emit('Big Book', 1); " +
                "else " +
                "   emit('Small Book', 1); " +
                "}";

        // 4Ô∏è‚É£ Reduce Function
        // Count number of books in each category
        String reduceFunction = "function(key, values) { " +
                "return Array.sum(values); " +
                "}";

        // 5Ô∏è‚É£ Perform MapReduce
        MongoIterable<Document> results = books.mapReduce(mapFunction, reduceFunction);

        System.out.println("\nüìò Categorized Books (MapReduce Result):");
        for (Document doc : results) {
            System.out.println(doc.toJson());
        }

        mongoClient.close();
    }
}
