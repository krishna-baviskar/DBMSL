Write a Stored Procedure namely proc_Grade for the categorization of student. If marks
scored by students in examination is <=1500 and marks>=990 then student will be placed in
distinction category if marks scored are between 989 and 900 category is first class, if marks
899 and 825 category is Higher Second Class. Write a PL/SQL block for using procedure
created with above requirement.
Stud_Marks(rollno, name, total_marks)
Result(Roll,Name, Class)


-- Drop existing tables (optional cleanup)
DROP TABLE Stud_Marks PURGE;
DROP TABLE Result PURGE;

-- 1️⃣ Create the tables
CREATE TABLE Stud_Marks (
    rollno NUMBER PRIMARY KEY,
    name VARCHAR2(50),
    total_marks NUMBER
);

CREATE TABLE Result (
    roll NUMBER,
    name VARCHAR2(50),
    class VARCHAR2(30)
);

-- 2️⃣ Insert sample data
INSERT INTO Stud_Marks VALUES (1, 'Krishna', 1200);
INSERT INTO Stud_Marks VALUES (2, 'Ravi', 950);
INSERT INTO Stud_Marks VALUES (3, 'Amit', 860);
INSERT INTO Stud_Marks VALUES (4, 'Neha', 780);
COMMIT;

-- 3️⃣ Create Stored Procedure
CREATE OR REPLACE PROCEDURE proc_Grade IS
    v_roll Stud_Marks.rollno%TYPE;
    v_name Stud_Marks.name%TYPE;
    v_marks Stud_Marks.total_marks%TYPE;
    v_class VARCHAR2(30);
    
    CURSOR c_student IS
        SELECT rollno, name, total_marks FROM Stud_Marks;
BEGIN
    -- Loop through each student
    OPEN c_student;
    LOOP
        FETCH c_student INTO v_roll, v_name, v_marks;
        EXIT WHEN c_student%NOTFOUND;

        -- Categorize marks
        IF v_marks BETWEEN 990 AND 1500 THEN
            v_class := 'Distinction';
        ELSIF v_marks BETWEEN 900 AND 989 THEN
            v_class := 'First Class';
        ELSIF v_marks BETWEEN 825 AND 899 THEN
            v_class := 'Higher Second Class';
        ELSE
            v_class := 'Fail';
        END IF;

        -- Insert result into Result table
        INSERT INTO Result VALUES (v_roll, v_name, v_class);
    END LOOP;

    CLOSE c_student;
    COMMIT;
END;
/
-- ✅ Procedure created successfully

-- 4️⃣ Execute Procedure using PL/SQL block
BEGIN
    proc_Grade;
    DBMS_OUTPUT.PUT_LINE('Student Grades inserted successfully!');
END;
/

-- 5️⃣ Display Results
SET SERVEROUTPUT ON;
BEGIN
    DBMS_OUTPUT.PUT_LINE('--- Final Result Table ---');
    FOR rec IN (SELECT * FROM Result ORDER BY roll) LOOP
        DBMS_OUTPUT.PUT_LINE(rec.roll || ' | ' || rec.name || ' | ' || rec.class);
    END LOOP;
END;
/
